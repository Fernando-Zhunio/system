<div>
  <div>
    <h2 class="font-facebook font-3xl my-2">{{title}}</h2>
  </div>
  <mat-horizontal-stepper linear #stepper class="rounded-fz">
    <mat-step [editable]="true">
      <div class="row">
        <ng-template matStepLabel>Seleccionador de usuarios</ng-template>
        <div class="col-md-6">
          <div class="search-container">
            <input (keydown.enter)="searchUser()" class="input-search" placeholder="Buscador de Usuario"
              [(ngModel)]="searchText" name="search">
            <button class="btn-search" matSuffix (click)="searchUser()" mat-mini-fab>
              <mat-icon>search</mat-icon>
            </button>
          </div>
          <mat-card class="rounded-fz shadow">

            <mat-selection-list *ngIf="!isLoading && users.size > 0; else loaderTemplate" [multiple]="false">
              <mat-list-option [disabled]="usersSelect.has(user.key)" (click)="addUser(user.key)" [value]="user.key"
                *ngFor="let user of users | keyvalue">
                <div class="d-flex align-items-center">
                  <img class="photo-user" [src]="getPhoto(user.value?.person?.photo?.permalink)" />
                  &nbsp; {{user.value?.name}}
                </div>
              </mat-list-option>
            </mat-selection-list>
            <ng-template #loaderTemplate>
              <div class="text-center" *ngIf="users.size <= 0 && !isLoading">
                <p class="font-3xl text-muted">Sin datos de usuarios</p>
                <div class="w-100">
                  <img class="w-50" src="assets/img/respuesta_vacia.svg" alt="">
                </div>
              </div>
              <p *ngIf="isLoading" class="parpadeo font-2xl p-3 text-muted">
                Cargando espere...
              </p>
            </ng-template>
          </mat-card>
        </div>
        <div class="col-md-6">
          <h2 class="font-facebook font-2xl">Usuarios seleccionados</h2>
          <div class="text-danger" *ngIf="usersSelect.size < 2">Debe seleccionar por lo menos dos integrantes</div>
          <mat-card *ngIf="usersSelect.size > 0" class="rounded-fz shadow">
            <mat-selection-list [multiple]="false">
              <mat-list-option [value]="user.key" *ngFor="let user of usersSelect | keyvalue">
                <div class="d-flex align-items-center justify-content-between">
                  <span>
                    <img class="photo-user" [src]="getPhoto(user.value?.person?.photo?.permalink)" />
                    &nbsp; {{user.value?.name}}
                  </span>
                  <span>
                    <mat-checkbox [(ngModel)]="user.value.isAdmin" color="primary"><small>Hacer admin</small>
                    </mat-checkbox>
                    <button color="warn" mat-icon-button (click)="removeUser(user.key)">
                      <mat-icon>close</mat-icon>
                    </button>
                  </span>
                </div>
              </mat-list-option>
            </mat-selection-list>
            <div>
              <button mat-raised-button [disabled]="usersSelect.size  < 2" matStepperNext color="primary"
                class="my-2">Siguiente <mat-icon>arrow_forward</mat-icon></button>
            </div>
          </mat-card>
        </div>
      </div>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Datos del Grupo</ng-template>
      <div class="container text-center">
        <div>
          <div *ngIf="img?.base64" class="position-relative">
            <span class="file-img">
              <label for="file">
                <span class="btn-primary rounded-circle p-2 center">
                  <mat-icon>edit</mat-icon>
                </span>
              </label>
              <input id="file" (change)="getBase64($event)" type="file" class="d-none" name="file">
            </span>
            <button (click)="removeImg()" *ngIf="img.file" class="position-absolute" color="warn" mat-icon-button>
              <mat-icon>delete</mat-icon>
            </button>
            <img [src]="img?.base64" class="img rounded-circle">
          </div>
        </div>
        <mat-form-field class="col-md-8 col-12">
          <input [(ngModel)]="nameGroup" matInput placeholder="Ingrese el nombre del grupo" required>
        </mat-form-field>
      </div>

      <div class="my-2">
        <button mat-raised-button matStepperPrevious color="accent">
          <mat-icon>arrow_back</mat-icon> Atras
        </button>
        <button mat-raised-button color="primary" [disabled]="isLoading" (click)="saveInServer()">Guardar</button>
      </div>
    </mat-step>
  </mat-horizontal-stepper>
</div>